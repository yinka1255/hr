jQuery(document).ready(function(g){"use strict";function r(e,t){if(!g.isArray(t)||""==e)return!1;for(var n=t.length,i=0;i<n;i++)if(t[i]==e)return!0;return!1}function i(e){e.preventDefault();var t=g(this),n=t.closest(".field-video"),i=g("a.add_field_video",n),l=i.find("video").data("id"),a=n.find("input").val();a=""==a?new Array:a.split(/,/);for(var o=0;o<a.length;o++)a[o]==l&&a.splice(o,1);i.html(i.attr("title")),n.find("input").val("").trigger("change"),t.hide()}function a(){var e=g(this),t=e.closest(".preview-image"),n=e.closest(".field-image"),i=t.find("img").data("id"),l=n.find("input").val();l=""==l?new Array:l.split(/,/);for(var a=0;a<l.length;a++)l[a]==i&&l.splice(a,1);t.remove(),n.find("input").val(l.join(",")).trigger("change")}function d(e){var t=g(".render-tag",e),i=new Array;return t.length?(t.each(function(){if(g(this).parent().is(".element-column")&&g(this).is(".open-tag")){var e=g(this).closest(".element-column").data("column"),t=g(this).text();t=t.replace("]",' column="'+e+'"]'),i.push(t)}else{var n=g(this).text();g(this).is(".content-tag")&&(n=window.switchEditors.pre_wpautop(n),n=window.switchEditors.wpautop(n)),i.push(n)}}),i.join("")):""}function w(){var t,n=g("#content"),e=".editor-worksheet";if(!n.length||!e.length)return!1;t=d(e);var i=n.closest(".wp-editor-wrap");if("undefined"!=typeof tinymce)if(window.switchEditors.go("content","tmce"),i.is(".tmce-active"))try{window.tinymce.get("content").setContent(t)}catch(e){n.val(t)}else try{tinymce.get("content").setContent(t)}catch(e){n.val(t)}else n.val(t)}function c(){g(".editor-worksheet .element-parent").length&&g(".editor-worksheet .element-parent").each(function(){var e=g(this),t=e.data("tag");e.find(" > .dropable-element").sortable({connectWith:'.element-parent[data-tag="'+t+'"]> .dropable-element',cursor:"move",handle:"> .element-toolbar .element-holder, > .element-holder, > .element-panel .element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){if(!t.item.is(".element-row")&&t.item.parent().is(".editor-worksheet"))return!1;w()},over:function(e,t){if(!t.item.is(".element-row")&&t.placeholder.parent().is(".editor-worksheet"))return t.placeholder.addClass("sortable-placeholder-hidden"),!1;t.placeholder.removeClass("sortable-placeholder-hidden")}}),e.find(".element-child > .dropable-element").sortable({connectWith:".element-column > .dropable-element,.element-container > .dropable-element,.element-box-item > .dropable-element,.element-child > .dropable-element",cursor:"move",handle:"> .element-toolbar .element-holder, > .element-holder, > .element-panel .element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){if(!t.item.is(".element-row")&&t.item.parent().is(".editor-worksheet"))return!1;t.item.find("> .element-panel > .element-holder.dragger").removeClass("dragger").html('<i title="'+C.move_this_element+'" class="fa fa-arrows"></i>'),w()},over:function(e,t){if(!t.item.is(".element-row")&&t.placeholder.parent().is(".editor-worksheet"))return t.placeholder.addClass("sortable-placeholder-hidden"),!1;t.placeholder.removeClass("sortable-placeholder-hidden")}})})}function s(){g(".editor-worksheet .element-container > .dropable-element, .editor-worksheet .element-box-item > .dropable-element").sortable({cursor:"move",connectWith:".element-column > .dropable-element,.element-container > .dropable-element,.element-box-item > .dropable-element",handle:"> .element-toolbar .element-holder,> .element-panel .element-holder, > .element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){if(t.item.is(".element-child,.element-frebase")&&t.item.parent().is(".editor-worksheet"))return!1;t.item.find("> .element-panel > .element-holder.dragger").removeClass("dragger").html('<i title="'+C.move_this_element+'" class="fa fa-arrows"></i>'),w()},over:function(e,t){if(t.item.is(".element-child,.element-frebase")&&t.placeholder.parent().is(".editor-worksheet")||t.item.is(".element-container"))return t.placeholder.addClass("sortable-placeholder-hidden"),!1;t.placeholder.removeClass("sortable-placeholder-hidden")}})}function m(){g(".editor-worksheet .element-column > .dropable-element").sortable({cursor:"move",connectWith:".editor-worksheet .element-column > .dropable-element,.editor-worksheet .element-container > .dropable-element,.editor-worksheet .element-box-item > .dropable-element,.element-child > .dropable-element, .editor-worksheet",handle:"> .element-toolbar .element-holder, > .element-holder,> .inside_row > .element-toolbar .element-holder,> .element-panel .element-holder",tolerance:"pointer",forcePlaceholderSize:!0,start:function(){},stop:function(e,t){return!(!t.item.is(".element-row,.element-container,.element-el_separator")&&t.item.parent().is(".editor-worksheet"))&&((!t.item.is(".element-container")||!t.item.parent().is(".element-container > .dropable-element"))&&(t.item.is(".element-row")?u(t.item):t.item.find("> .element-panel > .element-holder.dragger").removeClass("dragger").html('<i title="'+C.move_this_element+'" class="fa fa-arrows"></i>'),void w()))},over:function(e,t){return!t.item.is(".element-row,.element-container,.element-el_separator")&&t.placeholder.parent().is(".editor-worksheet")?(t.placeholder.addClass("sortable-placeholder-hidden"),!1):t.item.is(".element-container")&&t.placeholder.parent().is(".element-container > .dropable-element")?(t.placeholder.addClass("sortable-placeholder-hidden"),!1):void t.placeholder.removeClass("sortable-placeholder-hidden")}})}function u(e){if(e.closest(".element-column").length){var t=e.closest(".element-column");if(t.is('[data-tag="el_column"]')){var n=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.column-container >.element-column"):e.find(">.column-container >.element-column");l=(l=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.open-tag.render-tag"):e.find(">.open-tag.render-tag")).html().replace("el_inner_row_3","el_row").replace("el_inner_row_2","el_row").replace("el_inner_row_1","el_row").replace("el_row","el_inner_row");var i=n.find(">.open-tag.render-tag").html().replace("el_inner_column_3","el_column").replace("el_inner_column_2","el_column").replace("el_inner_column_1","el_column").replace("el_column","el_inner_column");e.attr("data-tag","el_inner_row"),e.data("tag","el_inner_row"),e.hasClass("element-row")&&e.find("> .inside_row").length?(e.find("> .inside_row >.close-tag.render-tag").html("[/el_inner_row]"),e.find("> .inside_row >.open-tag.render-tag").html(l)):(e.find(">.close-tag.render-tag").html("[/el_inner_row]"),e.find(">.open-tag.render-tag").html(l)),n.attr("data-tag","el_inner_column"),n.data("tag","el_inner_column"),n.find(">.close-tag.render-tag").html("[/el_inner_column]"),n.find(">.open-tag.render-tag").html(i),(a=n.find(">.element-content >.element-row")).length&&u(a)}else if(t.is('[data-tag="el_inner_column"]')){n=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.column-container >.element-column"):e.find(">.column-container >.element-column");l=(l=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.open-tag.render-tag"):e.find(">.open-tag.render-tag")).html().replace("el_inner_row_3","el_row").replace("el_inner_row_2","el_row").replace("el_row","el_inner_row").replace("el_inner_row","el_inner_row_1");i=n.find(">.open-tag.render-tag").html().replace("el_inner_column_3","el_column").replace("el_inner_column_2","el_column").replace("el_column","el_inner_column").replace("el_inner_column","el_inner_column_1");e.attr("data-tag","el_inner_row_1"),e.data("tag","el_inner_row_1"),e.hasClass("element-row")&&e.find("> .inside_row").length?(e.find("> .inside_row >.close-tag.render-tag").html("[/el_inner_row_1]"),e.find("> .inside_row >.open-tag.render-tag").html(l)):(e.find(">.close-tag.render-tag").html("[/el_inner_row_1]"),e.find(">.open-tag.render-tag").html(l)),n.attr("data-tag","el_inner_column_1"),n.data("tag","el_inner_column_1"),n.find(">.close-tag.render-tag").html("[/el_inner_column_1]"),n.find(">.open-tag.render-tag").html(i),(a=n.find(">.element-content >.element-row")).length&&u(a)}else if(t.is('[data-tag="el_inner_column_1"]')){n=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.column-container >.element-column"):e.find(">.column-container >.element-column");l=(l=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.open-tag.render-tag"):e.find(">.open-tag.render-tag")).html().replace("el_inner_row_3","el_row").replace("el_row","el_inner_row").replace("el_inner_row_1","el_inner_row").replace("el_inner_row","el_inner_row_2");i=n.find(">.open-tag.render-tag").html().replace("el_inner_column_3","el_column").replace("el_column","el_inner_column").replace("el_inner_column_1","el_inner_column").replace("el_inner_column","el_inner_column_2");e.attr("data-tag","el_inner_row_2"),e.data("tag","el_inner_row_2"),e.hasClass("element-row")&&e.find("> .inside_row").length?(e.find("> .inside_row >.close-tag.render-tag").html("[/el_inner_row_2]"),e.find("> .inside_row >.open-tag.render-tag").html(l)):(e.find(">.close-tag.render-tag").html("[/el_inner_row_2]"),e.find(">.open-tag.render-tag").html(l)),n.attr("data-tag","el_inner_column_2"),n.data("tag","el_inner_column_2"),n.find(">.close-tag.render-tag").html("[/el_inner_column_2]"),n.find(">.open-tag.render-tag").html(i),(a=n.find(">.element-content >.element-row")).length&&u(a)}else{if(!t.is('[data-tag="el_inner_column_2"]'))return e.appendTo(".editor-worksheet"),u(e),!1;n=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.column-container >.element-column"):e.find(">.column-container >.element-column");l=(l=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.open-tag.render-tag"):e.find(">.open-tag.render-tag")).html().replace("el_inner_row_2","el_row").replace("el_row","el_inner_row").replace("el_inner_row_1","el_inner_row").replace("el_inner_row","el_inner_row_3");i=n.find(">.open-tag.render-tag").html().replace("el_inner_column_2","el_column").replace("el_column","el_inner_column").replace("el_inner_column_1","el_inner_column").replace("el_inner_column","el_inner_column_3");e.attr("data-tag","el_inner_row_3"),e.data("tag","el_inner_row_3"),e.hasClass("element-row")&&e.find("> .inside_row").length?(e.find("> .inside_row >.close-tag.render-tag").html("[/el_inner_row_3]"),e.find("> .inside_row >.open-tag.render-tag").html(l)):(e.find(">.close-tag.render-tag").html("[/el_inner_row_3]"),e.find(">.open-tag.render-tag").html(l)),n.attr("data-tag","el_inner_column_3"),n.data("tag","el_inner_column_3"),n.find(">.close-tag.render-tag").html("[/el_inner_column_3]"),n.find(">.open-tag.render-tag").html(i),(a=n.find(">.element-content >.element-row")).length&&u(a)}}else{var l;n=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.column-container >.element-column"):e.find(">.column-container >.element-column");l=(l=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.open-tag.render-tag"):e.find(">.open-tag.render-tag")).html().replace("el_inner_row_2","el_row").replace("el_inner_row_3","el_row").replace("el_inner_row_1","el_inner_row").replace("el_inner_row","el_row");var a;i=n.find(">.open-tag.render-tag").html().replace("el_inner_column_2","el_column").replace("el_inner_column_3","el_column").replace("el_inner_column_1","el_inner_column").replace("el_inner_column","el_column");e.attr("data-tag","el_row"),e.data("tag","el_row"),e.hasClass("element-row")&&e.find("> .inside_row").length?(e.find("> .inside_row >.close-tag.render-tag").html("[/el_row]"),e.find("> .inside_row >.open-tag.render-tag").html(l)):(e.find(">.close-tag.render-tag").html("[/el_row]"),e.find(">.open-tag.render-tag").html(l)),n.attr("data-tag","el_column"),n.data("tag","el_column"),n.find(">.close-tag.render-tag").html("[/el_column]"),n.find(">.open-tag.render-tag").html(i),(a=n.find(">.element-content >.element-row")).length&&u(a)}}function h(e,t,n){if(t!=n){var l=e.find("> .inside_row > .column-container"),i=l.find("> .element-column"),a="12"!=t?t.split(" ",12):new Array("12"),o=a.length,r=("12"!=n?n.split(" ",12):new Array("12")).length;if(i.length){i.each(function(e,t){g(t).removeClass(function(e,t){for(var n="",i=t.split(" "),l=0;l<i.length;l++)/col-\d{1,3}/.test(i[l])&&(n+=i[l]+" ");return n})});var d=l.width(),c=d/12;if(r<o){var s=o-r,m=l.find("> .element-column:last");try{m.resizable("enable")}catch(e){}for(var u=0;u<s;u++){var h=m.clone(!1);g(".ui-resizable-handle",h).remove(),h.find("> .element-content").html(""),l.append(h)}(i=l.find("> .element-column")).each(function(e,t){var n=a[e]*c/d*100;g(t).addClass("col-"+a[e]).data("column",a[e]).attr("data-column",a[e]),g(t).outerWidth(n+"%"),b(t)}),l.find(".dropable-element").sortable({cursor:"move",connectWith:".dropable-element,.editor-worksheet",handle:">.element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){if(!t.item.is(".element-row")&&t.item.parent().is(".editor-worksheet"))return!1;t.item.find("> .element-panel > .element-holder.dragger").removeClass("dragger").html('<i title="'+C.move_this_element+'" class="fa fa-arrows"></i>'),w()},over:function(e,t){if(!t.item.is(".element-row")&&t.placeholder.parent().is(".editor-worksheet"))return t.placeholder.addClass("sortable-placeholder-hidden"),!1;t.placeholder.removeClass("sortable-placeholder-hidden")}})}else if(o<r){i.find("> .element-content");i.each(function(e,t){if(e<o){var n=a[e]*c/d*100;g(t).addClass("col-"+a[e]).data("column",a[e]).attr("data-column",a[e]),g(t).outerWidth(n+"%"),o-1==e&&g(t).resizable("disable")}else{var i=g(t).find("> .element-content");l.find("> .element-column:first > .element-content").append(i.children()),g(t).remove()}})}else i.each(function(e,t){var n=a[e]*c/d*100;g(t).addClass("col-"+a[e]).data("column",a[e]).attr("data-column",a[e]),g(t).outerWidth(n+"%")});e.data("column",t),e.attr("data-column",t),T(),w()}}}function p(e){if(""==B)return alert(C.invalid_nonce);var t=g("#asTB_content"),i=g(".choose-templates",t),n=g("input[name=category_slug]",t).val(),l=g("input[name=stemp]",t).val(),a=g("#TB_new_window .spiner");g.ajax({type:"POST",url:ajaxurl+"?paged="+e,data:{action:"builder_load_block",_abuilder_nonce:B,category:n,search:l},beforeSend:function(){a.addClass("active")},dataType:"html",context:this}).done(function(e){var t=g(e),n=t.find(".pagination a");setTimeout(function(){a.removeClass("active")},500),n.length&&n.each(function(){g(this).unbind("click").click(function(e){e.preventDefault(),p(g(this).data("page"))})}),i.html(t),g(document).trigger("loaded"),g(".select_block_button").length&&g(".select_block_button").each(function(){var i=g(this);i.click(function(e){if(e.preventDefault(),""==B)return alert(C.invalid_nonce);var t=g(this).closest(".block-option").find(".content-tag"),n=t.length?t.val():"";if(n.match(/^\[el_((\w?){0,}row|separator).*?\]/)||(n.match(/\]$/)&&n.match(/^\[.*/)||(n="[el_text_html]"+n+"[/el_text_html]"),n='[el_row][el_column column="12"]'+n+"[/el_column][/el_row]"),""==n)return k();g.ajax({type:"POST",url:ajaxurl,data:{action:"builder_add_shortcode",_abuilder_nonce:B,shortcode:n},dataType:"html",beforeSend:function(){i.addClass("active")},context:this}).done(function(e){e=e.replace(/\\/g,"");var t=g(".editor-worksheet"),n=g(e);u(n),1==t.find(".dropable-element").length&&""==t.find(".dropable-element").text()?t.html(n):t.append(n),c(),m(),y(),s(),T(),w(),setTimeout(function(){i.removeClass("active"),i.closest(".block-option").addClass("added")},500)})})})})}function f(l,e){if(""==B)return alert(C.invalid_nonce);var t=g("#asTB_content"),i=g(".choose-templates",t),n=g("input[name=category_slug]",t).val(),a=g("input[name=stemp]",t).val(),o=g("#TB_new_window .spiner");if(void 0===e)e=1;g.ajax({type:"POST",url:ajaxurl+"?paged="+e,data:{action:"builder_load_element",_abuilder_nonce:B,category:n,search:a},beforeSend:function(){o.addClass("active")},dataType:"html",context:this}).done(function(e){var t=g(e),n=t.find(".pagination a");setTimeout(function(){o.removeClass("active")},500),n.length&&n.each(function(){g(this).unbind("click").click(function(e){e.preventDefault();var t=g(this).data("page");f(l,t)})}),i.html(t),g(document).trigger("loaded"),g(".select_block_button").length&&g(".select_block_button").each(function(){var i=g(this);i.click(function(e){if(e.preventDefault(),""==B)return alert(C.invalid_nonce);var t=g(this).closest(".block-option").find(".content-tag"),n=t.length?t.val():"";if(""==n)return k();g.ajax({type:"POST",url:ajaxurl,data:{action:"builder_add_shortcode",_abuilder_nonce:B,shortcode:n},dataType:"html",beforeSend:function(){i.addClass("active")},context:this}).done(function(e){e=e.replace(/\\/g,"");var t=g(e);l.append(t);var n=l.find("> .element-row");n.length?u(n):(n=l.find(".element-row")).length&&u(n),c(),m(),y(),s(),T(),w(),setTimeout(function(){i.removeClass("active"),i.closest(".block-option").addClass("added")},1e3)})})})})}function v(e,t){return Math.round(e/t*12)}function b(e){g(e).resizable({handles:"e",minWidth:10,create:function(){g(this).next().length||g(this).resizable("disable")},resize:function(e,t){var n=t.helper.outerWidth(!0),i=t.helper.next(),l=(t.helper.prev(),t.helper.parent());i.addClass("ui-resizable-adjust"),t.helper.addClass("ui-resizable-adjust");var a,o,r=(a=0,(o=l.find("> .element-builder:NOT(.ui-resizable-adjust)")).length&&o.each(function(e,t){a+=g(t).outerWidth(!0)}),a),d=l.width(),c=d/12;t.size.width<=c&&(t.size.width=n=c);var s=d-r-n;s<=c&&(t.size.width=d-r-c,s=c),i.outerWidth(s-1)},stop:function(e,t){t.helper.siblings().removeClass("ui-resizable-adjust"),t.helper.removeClass("ui-resizable-adjust");var n=t.helper.parent().width(),i=n/12,l=t.helper.next(),a=v(t.size.width,n),o=v(l.outerWidth(),n),r=a*i/n*100,d=o*i/n*100;t.helper.outerWidth(r+"%"),t.helper.data("column",a),t.helper.attr("data-column",a),l.outerWidth(d+"%"),l.data("column",o),l.attr("data-column",o),w()}})}function y(){g(".editor-worksheet .element-builder.element-column").each(function(e,t){b(t)})}function k(){return g(".html-editor").length&&"undefined"!=typeof tinyMCE&&g(".html-editor").each(function(){var e=g(this).attr("id");tinymce.execCommand("mceRemoveEditor",!0,e)}),g("#TB_imageOff").unbind("click"),g("#TB_closeWindowButton").unbind("click"),g("#TB_new_window").fadeOut("fast",function(){g("#TB_new_window,#TB_new_overlay,#TB_HideSelect").trigger("tb_unload").unbind().remove()}),g("body").removeClass("modal-open"),g("#TB_load").remove(),g("#TB_load").remove("modal-open"),g("body").removeClass(""),void 0===document.body.style.maxHeight&&(g("body","html").css({height:"auto",width:"auto"}),g("html").css("overflow","")),g(document).unbind(".thickbox"),!1}function T(){g(".element-builder .builder_handlediv").unbind("click").click(function(e){var t=g(this).closest(".element-builder");e.preventDefault(),t.toggleClass("closed")}),g(".element-builder .element-setting a").unbind("click").click(function(e){if(e.preventDefault(),""==B)return alert(C.invalid_nonce);var t,n=g(this),i=n.closest(".element-builder"),l=n.parent().data("title"),a=Math.floor(-999998*Math.random()+1e6)+(new Date).getTime(),o=i.data("tag"),r=i.hasClass("element-row")?i.find("> .inside_row > .open-tag.render-tag"):i.find("> .open-tag.render-tag"),d=i.hasClass("element-row")?i.find("> .inside_row > .content-tag.render-tag"):i.find("> .content-tag.render-tag"),c=i.find("> .element-preview"),s=i.hasClass("element-row")?i.find("> .inside_row > .close-tag.render-tag"):i.find("> .close-tag.render-tag");null===document.getElementById("TB_new_overlay")&&(g("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),g("#TB_new_overlay").click(k),g("body").addClass("modal-open"));var m=g("#TB_new_window"),u=g("<form id='asTB_content' class='setting-element setting-element-"+o+"' method='post'></form>"),h=g('<a id="save_shortcode_module" href="#"></a>').text(C.save),p=g('<a id="cancel_shortcode_module" href="#"></a>').text(C.cancel),_=g("<div id='TB_bottom'></div>").append(h,p);m.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.edit_title_panel+" "+l+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),m.append(u,_),g("#asasTB_closeWindowButton").click(k),t=r.text()+d.text()+s.text(),g.ajax({type:"POST",url:ajaxurl,data:{action:"builder_get_setting",tag:o,_abuilder_nonce:B,identified:a,shortcode:t},dataType:"html",context:this}).done(function(e){u.append(g(e)),g(document).trigger("loaded")}),m.css({visibility:"visible"}),p.click(k),h.click(function(e){e.preventDefault(),g(".html-editor").length&&"undefined"!=typeof tinymce&&g(".html-editor").each(function(){var e,t=g(this),n=t.attr("id");t.closest(".wp-editor-wrap").is(".tmce-active")&&(e=tinymce.get(n).getContent(),t.val(e)),"4"===tinymce.majorVersion?window.tinyMCE.execCommand("mceRemoveEditor",!0,n):window.tinyMCE.execCommand("mceRemoveControl",!0,n)});var t=u.serialize();g.ajax({type:"POST",url:ajaxurl,data:{action:"builder_save_setting",tag:o,_abuilder_nonce:B,identified:a,shortcode:t},dataType:"html",context:this}).done(function(e){var t=g("<div>"+e+"</div>"),n=g(".shorcode_tag",t),i=g(".shorcode_content",t).html(),l=g(".shorcode_preview",t);r.html(n.html()),d.text(i),c&&c.html(l.html()),w(),k()})});var f=!1,v=!1;g(document).unbind("keydown").unbind("keyup").keydown(function(e){17==e.keyCode&&(f=!0),16==e.keyCode&&!0,18==e.keyCode&&(v=!0),f&&v&&88==e.keyCode&&k(),f&&v&&83==e.keyCode&&h.click()}).keyup(function(e){17==e.keyCode&&(f=!1),16==e.keyCode&&!1,18==e.keyCode&&(v=!1)})}),g(".element-builder .element-addshortcode a").unbind("click").click(function(e){e.preventDefault();var n=g(this).closest(".element-builder").find("> .element-content");null===document.getElementById("TB_new_overlay")&&(g("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),g("#TB_new_overlay").click(k),g("body").addClass("modal-open"));var t=g("#TB_new_window"),i=g("<div class='asTB_content_container'></div>"),l=g('<a id="cancel_shortcode_module" class="btn" href="#"></a>').text(C.close),a=g("#template_category_options").clone(),o=g("<div id='TB_bottom'></div>").append(l),r=g('<input placeholder="'+C.search_placehold+'" name="stemp" type="text" />'),d=g('<input type="hidden" name="category_slug" />');r.addClass("search-template");var c=g('<form id="asTB_content" method="post"></form>'),s=g('<div class="spiner"><i class="fa-spinner"></i></div>');c.append(r,d,'<div class="choose-templates"></div>'),i.append(a,c),t.addClass("block-loader"),t.append(s),t.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.element_library_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),t.append(i,o),a.find(".select-category").each(function(){g(this).click(function(e){e.preventDefault();var t=g(this).data("slug");return d.val(t),r.val(""),f(n,1)})});r.unbind("keydown").unbind("keyup").keydown(function(e){if(13==e.keyCode)return e.preventDefault(),f(n,1);!0}).keyup(function(){g(this).val().length<3||setTimeout(function(){f(n,1)},1e3)}),g("#asasTB_closeWindowButton").click(k),f(n,1),t.css({visibility:"visible"}),a.show(),l.click(k)}),g(".element-builder .element-shortcode a").unbind("click").click(function(e){e.preventDefault();var t=g(this).closest(".element-builder");null===document.getElementById("TB_new_overlay")&&(g("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),g("#TB_new_overlay").click(k),g("body").addClass("modal-open"));var n=g("#TB_new_window"),i=g("<form id='asTB_content' method='post'></form>"),l=g('<a id="cancel_shortcode_module" href="#"></a>').text(C.close),a=g('<textarea class="custom_css_editor_area" name="custom_css" readonly="readonly"></textarea>'),o=g("<div id='TB_bottom'></div>").append(l),r=d(t);a.val(r),n.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.show_shortcode_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),n.append(i,o),g("#asasTB_closeWindowButton").click(k),i.append(a),n.css({visibility:"visible"}),l.click(k)}),g(".select-column").unbind("click").click(function(){var t=g(this).closest(".toolbar").find(".option-column-group"),n=g(this);t.toggleClass("open"),n.toggleClass("expand"),g("body").click(function(e){g(e.target).is(t)||t.has(e.target).length||n.has(e.target).length||(t.removeClass("open"),n.removeClass("expand"))})}),g(".option-column-group .option-column a").unbind("click").click(function(e){e.preventDefault();var i=g(this).closest(".element-builder.element-row"),t=g(this).data("column"),n=i.data("column"),l=g(this).closest(".option-column-group");if(g(this).is(".column_custom")){if(g(".option-custom",l).length){(a=g(".option-custom")).show()}else{var a=g("<li></li>").addClass("option-custom"),o=g('<a href="#" class="cancelColumn">'+C.cancel+"</a>"),r=g('<a href="#" class="saveColumn">'+C.save+"</a>"),d=g('<input type="text" name="columnTo" placeholder="'+C.custom_column_placeholder+'" value="" />');a.append(d,r,o),l.append(a),o.click(function(e){e.preventDefault(),a.hide({duration:100,complete:function(){l.removeClass("open")}})}),r.click(function(e){e.preventDefault();var t=d.val(),n=i.data("column");h(i,t,n),m(),y(),a.hide({duration:100,complete:function(){l.removeClass("open"),d.val("")}})}),d.on("keyup",function(){var n=0,e=g(this).val().split(" ",12);g.each(e,function(e,t){n+=parseInt(t)}),12==n?r.show():r.hide()}),d.on("keypress",function(n){if(13==n.which){n.preventDefault();n=0;var e=g(this).val().split(" ",12);g.each(e,function(e,t){n+=parseInt(t)}),12==n&&r.trigger("click")}}),d.trigger("keyup")}g('input[name="columnTo"]',l).focus()}else l.removeClass("open"),h(i,t,n),m()}),g(".element-builder .element-delete a").unbind("click").click(function(e){e.preventDefault();var t=g(this).closest(".element-builder");!0===confirm(C.are_you_sure_delete_confirmation)&&(t.remove(),w())}),g(".element-builder .element-delete-column a").unbind("click").click(function(e){e.preventDefault();var t=g(this).closest(".element-builder");if(!t.siblings().length)return alert(C.column_canot_delete);var n=confirm(C.are_you_sure_delete_column_confirmation),i=t.next(),l=t.prev(),a=t.parent().closest(".element-builder.element-row"),o=parseInt(t.data("column"));if(!0===n){if(l.length){var r=parseInt(l.data("column"))+o;l.data("column",r),l.attr("data-column",r);var d=r/12*100;l.outerWidth(d+"%")}else{if(!i.length)return;var c=parseInt(i.data("column"))+o;i.data("column",c),i.attr("data-column",c);var s=c/12*100;i.outerWidth(s+"%")}t.remove();var m=a.find("> .inside_row > .column-container >.element-column");if(m.length){var u=[],h=0,p="12";m.each(function(e,t){var n=parseInt(g(t).data("column"));h+=n,u.push(n)}),12==h&&(p=u.join(" ",u)),a.data("column",p),a.attr("data-column",p)}w()}}),g(".element-builder .element-copy a").unbind("click").click(function(e){e.preventDefault();var t=g(this).closest(".element-builder"),n=t.clone(!1);g(".ui-resizable-handle",n).remove(),t.after(n),c(),m(),y(),s(),T(),w()}),g(".element-builder .element-up a").unbind("click").click(function(e){e.preventDefault();var t=g(this).closest(".element-builder"),n=(t.parent(),t.prev()),i=t.outerHeight(!0);n.length&&(n.before(t),w(),g(document).scrollTop(g(document).scrollTop()-i-20))}),g(".element-builder .element-down a").unbind("click").click(function(e){e.preventDefault();var t=g(this).closest(".element-builder"),n=(t.parent(),t.next()),i=t.outerHeight(!0);n.length&&(n.after(t),w(),g(document).scrollTop(g(document).scrollTop()+i+20))}),g(".editor-worksheet .children-toolbar a").unbind("click").click(function(e){e.preventDefault();var t=g(this),n=t.closest(".element-builder"),i=g("> .element-content",n),l=t.data("child"),a=g(".element-builders").find('.element-builder[data-tag="'+l+'"]');if(a.length){var o=a.clone(!0);i.append(o.show()),w(),s(),m(),T(),c(),o.hasClass("show-create")&&o.find(".element-setting a").click()}}),g(".editor-worksheet .element-row").length&&g(".editor-worksheet .element-row").each(function(){var e=g(this),t="12",n=e.find("> .inside_row > .column-container >.element-column");if(n.length){var i=[],l=0;n.each(function(e,t){var n=parseInt(g(t).data("column"));l+=n,i.push(n)}),12==l&&(t=i.join(" ",i))}e.data("column",t)})}function e(e,t,n){var i;if(n){var l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3),i="; expires="+l.toGMTString()}else i="";document.cookie=escape(e)+"="+escape(t)+i+"; path=/"}Color.prototype.toString=function(e){if("no-alpha"==e)return this.toCSS("rgba","1").replace(/\s+/g,"");if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var t=parseInt(this._color,10).toString(16);if(this.error)return"";if(t.length<6)for(var n=6-t.length-1;0<=n;n--)t="0"+t;return"#"+t};var C=window.iab,B=g("#_abuilder_nonce").length?g("#_abuilder_nonce").val():"";wp.media.BuilderImageEdit={getData:function(){return this.formfield.val()},set:function(e){this.preview.html("");var t=g("<div></div>").addClass("preview-image"),n=g('<a><div class="fa fa-close"></div></a>').addClass("remove_field_image"),i=g('<img data-id="'+e.get("id")+'" src="'+e.attributes.url+'"/>');return t.append(i),n.click(a),t.append(n),this.preview.append(t),this.formfield.val(e.get("id")).trigger("change"),!1},frame:function(e){e.find(".add_field_image");var t=e.find(".remove_field_image"),n=(e.find("input"),e.find(".preview-images"));e.find(".preview-image");return n.length||(n=g("<div></div>").addClass("preview-images"),e.prepend(n)),this.field=e,this.formfield=e.find("input"),this.preview=n,t.click(a),this._frame||(this._frame=wp.media({id:"page_builder",state:"insert-image",title:C.insert_image,editing:!0,multiple:!1,toolbar:"insert-image",menu:"insert-image",type:"image",states:[new wp.media.controller.BuilderImageEdit]}),this._frame.on("toolbar:create:insert-image",function(e){this.createSelectToolbar(e,{text:C.insert_image})},this._frame),this._frame.state("insert-image").on("select",this.select)),this._frame},select:function(){var e=this.get("selection").single();wp.media.BuilderImageEdit.set(e||-1)}},wp.media.controller.BuilderImageEdit=wp.media.controller.FeaturedImage.extend({defaults:_.defaults({id:"insert-image",filterable:"uploaded",multiple:!1,toolbar:"insert-image",library:wp.media.query({type:"image"}),title:C.select_image,priority:60,syncSelection:!1},wp.media.controller.Library.prototype.defaults),updateSelection:function(){var e,t=this.get("selection"),n=wp.media.BuilderImageEdit.getData();""!==n&&-1!==n&&(e=wp.media.model.Attachment.get(n)).fetch(),t.reset(e?[e]:[])}}),wp.media.controller.BuilderImagesEdit=wp.media.controller.FeaturedImage.extend({defaults:_.defaults({id:"insert-image",filterable:"uploaded",multiple:"add",library:wp.media.query({type:"image"}),toolbar:"insert-image",title:C.select_image,priority:60,syncSelection:!1},wp.media.controller.Library.prototype.defaults),updateSelection:function(){var e=this.get("selection");wp.media.BuilderImagesEdit.getData();e.reset(void 0)}}),wp.media.BuilderImagesEdit={getData:function(){return this.formfield.val()},set:function(e){var i=this,t=this.formfield.val(),l=""!=t?t.split("/,/"):[];return e.map(function(e){e=e.toJSON(),l.push(e.id);var t=g("<div></div>").addClass("preview-image"),n=g('<a><div class="fa fa-close"></div></a>').addClass("remove_field_image");t.append(g('<img data-id="'+e.id+'" src="'+e.url+'"/>')),n.click(a),t.append(n),i.preview.append(t)}),this.formfield.val(l.join(",")).trigger("change"),!1},frame:function(e){e.find("input");var t=e.find(".preview-images");return this.formfield=e.find("input"),this.preview=t,this._frame||(this._frame=wp.media({id:"page_builder",state:"insert-image",title:C.insert_image,editing:!0,multiple:!0,toolbar:"insert-image",type:"image",states:[new wp.media.controller.BuilderImagesEdit]}),this._frame.on("toolbar:create:insert-image",function(e){this.createSelectToolbar(e,{text:C.insert_image})},this._frame),this._frame.state("insert-image").on("select",this.select)),this._frame},select:function(){var e=this.get("selection");wp.media.BuilderImagesEdit.set(e||-1)}},wp.media.BuilderVideoEdit={getData:function(){return this.formfield.val()},set:function(e){if(this.getData()==e.get("id"))return!1;var t=g('<video autoplay data-id="'+e.get("id")+'" width="266"/>'),n=g("<source/>"),i=e.attributes.mime,l=e.attributes.thumb.src;return n.attr("src",e.attributes.url),n.attr("type",i),t.attr("poster",l),t.append(n),this.preview.find("a.add_field_video").html(t),this.formfield.val(e.get("id")).trigger("change"),this.field.find(".remove_attach_video").show(),!1},frame:function(e){e.find(".add_field_video");var t=e.find(".remove_attach_video"),n=(e.find("input"),e.find(".preview-video"));return this.field=e,this.formfield=e.find("input"),this.preview=n,t.click(i),this._frame||(this._frame=wp.media({id:"wp_video",state:"insert-image",title:C.insert_video,editing:!0,multiple:!1,toolbar:"insert-image",menu:"insert-image",type:"image",states:[new wp.media.controller.BuilderVideoEdit({library:wp.media.query({type:"video/mp4,video/webm"})})]}),this._frame.on("toolbar:create:insert-image",function(e){this.createSelectToolbar(e,{text:C.select_video})},this._frame),this._frame.state("insert-image").on("select",this.select)),this._frame},select:function(){var e=this.get("selection").single();wp.media.BuilderVideoEdit.set(e||-1)}},wp.media.controller.BuilderVideoEdit=wp.media.controller.FeaturedImage.extend({defaults:_.defaults({id:"insert-image",filterable:"uploaded",multiple:!1,toolbar:"insert-image",library:wp.media.query({type:"video"}),title:C.select_video,priority:60,syncSelection:!1},wp.media.controller.Library.prototype.defaults),updateSelection:function(){var e,t=this.get("selection"),n=wp.media.BuilderVideoEdit.getData();""!==n&&-1!==n&&(e=wp.media.model.Attachment.get(n)).fetch(),t.reset(e?[e]:[])}}),g(document).on("loaded",function(){var o,e;g(".html-editor").length&&"undefined"!=typeof tinyMCE&&(window.switchEditors.go("content","tmce"),g(".html-editor").each(function(){var e,t,n;t=g(e=this).attr("id"),g(e).closest(".wp-editor-wrap"),n=e.value,window.tinyMCEPreInit.mceInit[t]=_.extend({},tinyMCEPreInit.mceInit.content,{resize:"vertical",height:200,id:t}),window.tinyMCEPreInit.mceInit[t].plugins=window.tinyMCEPreInit.mceInit[t].plugins.replace(/,?wpfullscreen/,""),_.isUndefined(tinyMCEPreInit.qtInit[t])&&(window.tinyMCEPreInit.qtInit[t]=_.extend({},tinyMCEPreInit.qtInit.replycontent,{id:t})),quicktags(window.tinyMCEPreInit.qtInit[t]),QTags._buttonsInit(),window.switchEditors.go(t,"tmce"),n=window.switchEditors.pre_wpautop(n),n=window.switchEditors.wpautop(n),tinymce.majorVersion,window.tinyMCE.execCommand("mceAddEditor",!0,t),window.tinymce.get(t).setContent(n)})),g(".field-image").length&&g(".field-image").each(function(){var e=g(this);e.find(".add_field_image").unbind("click").click(function(){g(this).is(".multi-image")?wp.media.BuilderImagesEdit.frame(e).open():wp.media.BuilderImageEdit.frame(e).open()}),e.find(".remove_field_image").unbind("click").click(a)}),g(".field-video").length&&g(".field-video").each(function(){var e=g(this);e.find(".add_field_video").unbind("click").click(function(){wp.media.BuilderVideoEdit.frame(e).open()}),e.find(".remove_attach_video").unbind("click").click(i)}),g(".radio-options").length&&g(".radio-options").each(function(){var e=g(this),t=g(".radio-option",e),n=g("input.radio-input-value",e);t.on("change",function(){n.val(g(this).val()).trigger("change")})}),g(".checkbox-options").length&&g(".checkbox-options").each(function(){var e=g(this),t=g(".checkbox-option",e),n=g("input.checkbox-input-value",e);t.on("change",function(){var e=[];t.each(function(){g(this).prop("checked")&&e.push(g(this).val())}),n.val(e.join(","))})}),g(".color-picker-field").length&&g(".color-picker-field").each(function(){var l=g(this),e=g(this).data("palletes"),t=l.val().replace(/\s+/g,"");if(t.match(/rgba\(\d+\,\d+\,\d+\,([^\)]+)\)/)){var n=100*parseFloat(t.match(/rgba\(\d+\,\d+\,\d+\,([^\)]+)\)/)[1]);n=parseInt(n)}else n=100;if("false"==e||0==e)var i=!1;else if("true"==e||1==e)i=!0;else i=l.data("palletes").split(",");l.wpColorPicker({palettes:i,clear:function(){a.find('[name="alpha"]').val(100),r.val("100%")}});var a=l.closest(".wp-picker-container").addClass("color_picker").find(".iris-picker").addClass("has-alpha"),o=g('<div class="alpha-container">Alpha: <output class="rangevalue">'+n+'%</output><input type="range" min="1" max="100" value="100" name="alpha" class="alpha-field"></div>');a.append(o);var r=a.find(".alpha-container output");a.find('[name="alpha"]').bind("change keyup",function(){var e,t=g(this),n=parseFloat(t.val()),i=l.data("a8cIris");l.data("wpWpColorPicker");r.val(n+"%"),i._color._alpha=n/100,l.val(i._color.toString()),e=l.val(),g(l).wpColorPicker("color",e)}).val(n).trigger("change")}),g(".option-select").length&&g(".option-select").each(function(){var e=g(this),t=g("input",e);g(".layout-option",e).click(function(){t.val(g(this).data("option")),g(".layout-option",e).removeClass("active"),g(this).addClass("active"),t.trigger("change")})}),g(".input-slider").length&&g(".input-slider").each(function(){var e=g(this),n=e.closest(".input-slider-container").find("input");e.on("change",function(){e.slider({value:n.val(),min:e.data("min"),max:e.data("max"),step:e.data("step"),slide:function(e,t){n.val(t.value).trigger("change")}})}).trigger("change"),n.on("keyup",function(){g(this).val()>e.data("max")&&g(this).val(e.data("max")),e.slider({value:g(this).val()}),g(this).trigger("change")})}),g(".setting-element .nav-tab a").length&&g(".setting-element .nav-tab a").each(function(){g(this).unbind("click").click(function(e){e.preventDefault();var t=g(this),n=t.data("tab"),i=t.closest(".nav-tab"),l=i.closest("form");i.siblings().removeClass("active"),i.addClass("active"),g(".group-content").removeClass("active"),g("#"+n).addClass("active"),l.scrollTop(0)})}),o=g("#asTB_content"),(e=g(".param_value",o)).length&&(e.each(function(){var e=g(this),t={};if(e.data("dependent")&&e.data("dependvalue")){t.dependency=e.attr("name"),t.dependency_value=e.data("dependvalue").toString();var n=g('[name="'+e.data("dependent")+'"]',o),i=n.data("param")?n.data("param"):[];i.push(t),n.data("param",i)}}),e.each(function(){g(this).on("change keyup",function(e){if("object"==typeof g(this).data("param")){var t=g(this).data("param");for(var e in t){var n=t[e],i="not_empty"==n.dependency_value,l=i?new Array("not_empty"):n.dependency_value.split(","),a=g('[name="'+n.dependency+'"]',o).closest(".field-wrap");i&&""!=g(this).val()?a.show():r(g(this).val(),l)?a.show():a.hide()}}}).trigger("change")}))});var t=g('<div class="editor-switch-container"/>'),n=g('<a class="button switch-editor" href="javascript:;">'+C.nuno_editor+"</a>"),l=g("#postdivrich"),o=g("#abuilder"),x=g("#abuilder_zoom_btn");g("#abuilder_update").click(function(e){e.preventDefault(),g("input[name=save]").click()}),x.click(function(e){e.preventDefault(),g("#collapse-button").click(),g(document).scroll()}),g("#collapse-button").on("click",function(){g(document).scroll()}),t.insertAfter("div#titlediv"),n.appendTo(t);var I,E,W,j=function(e){for(var t=escape(e)+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var l=n[i];" "===l.charAt(0);)l=l.substring(1,l.length);if(0===l.indexOf(t))return unescape(l.substring(t.length,l.length))}return null}("_hide_editor");o.hide(),"hide"!=j&&(o.show({complete:function(){g("#abuilder_wrap").show(),o.removeClass("closed"),n.text(C.classic_editor)}}),l.hide()),n.click(function(){l.toggle(),l.is(":visible")?(o.hide(),n.text(C.nuno_editor),e("_hide_editor","hide")):(o.show({complete:function(){g("#abuilder_wrap").show(),n.text(C.classic_editor)}}),e("_hide_editor","show"))}),g(".element-builders .element-row").draggable({connectToSortable:".editor-worksheet",helper:"clone",cursor:"move",handle:">.element-holder",drag:function(e,t){t.helper.width(400)},stop:function(e,t){t.helper.width("auto"),t.helper.height("auto"),t.helper.prepend(g('<div class="builder_handlediv" title="'+C.click_to_toggle+'"></div><h3 class="row-title">'+C.row+"</h3>")),m(),T()}}),g(".element-builders .element-frebase").draggable({connectToSortable:".element-column >.dropable-element,.element-container > .dropable-element,.element-box-item > .dropable-element,.element-child > .dropable-element",cursor:"move",helper:"clone",handle:">.element-holder, > .element-panel >.element-holder",start:function(){},drag:function(e,t){t.helper.width(200)},stop:function(e,t){t.helper.width("auto"),t.helper.height("auto"),T(),t.helper.hasClass("show-create")&&t.helper.find(".element-setting a").click()}}),g(".element-builders .element-el_separator").draggable({connectToSortable:".element-column >.dropable-element,.editor-worksheet,.element-box-item > .dropable-element",cursor:"move",helper:"clone",handle:">.element-holder, > .element-panel >.element-holder",start:function(){},drag:function(e,t){t.helper.width(200)},stop:function(e,t){t.helper.width("auto"),t.helper.height("auto"),T(),t.helper.hasClass("show-create")&&t.helper.find(".element-setting a").click()}}),g(".element-builders .element-container").draggable({connectToSortable:".element-column > .dropable-element",helper:"clone",cursor:"move",handle:"> .element-panel >.element-holder, >.element-holder",start:function(){},drag:function(e,t){t.helper.width(400)},stop:function(e,t){t.helper.width("auto"),t.helper.height("auto"),s(),T(),t.helper.hasClass("show-create")&&t.helper.find("> .element-panel .element-setting a").click()}}),g(".element-builders .element-parent").draggable({connectToSortable:".element-column > .dropable-element",helper:"clone",cursor:"move",handle:"> .element-panel >.element-holder, >.element-holder",start:function(){},drag:function(e,t){t.helper.width(400)},stop:function(e,t){t.helper.width("auto"),t.helper.height("auto"),c(),T(),t.helper.hasClass("show-create")&&t.helper.find(".element-setting a").click()}}),(I=g(".editor-worksheet")).show(),I.sortable({connectWith:".element-column > .dropable-element",cursor:"move",handle:"> .element-panel .element-holder, > .element-toolbar .element-holder, > .inside_row > .element-toolbar .element-holder, > .element-holder, > .element-toolbar .element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){if(!t.item.is(".element-row, .element-el_separator")&&t.item.parent().is(".editor-worksheet"))return!1;t.item.is(".element-row")?u(t.item):t.item.find("> .element-panel > .element-holder.dragger").removeClass("dragger").html('<i title="'+C.move_this_element+'" class="fa fa-arrows"></i>'),m(),T(),w()},over:function(e,t){if(!t.item.is(".element-row, .element-el_separator")&&t.placeholder.parent().is(".editor-worksheet"))return t.placeholder.addClass("sortable-placeholder-hidden"),!1;t.placeholder.removeClass("sortable-placeholder-hidden")}}),s(),m(),T(),c(),y(),g(".add-page-shortcode").click(function(e){if(e.preventDefault(),""==B)return alert(C.invalid_nonce);null===document.getElementById("TB_new_overlay")&&(g("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),g("#TB_new_overlay").click(k),g("body").addClass("modal-open"));var t=g("#TB_new_window"),n=g("<form id='asTB_content' method='post'></form>"),i=g('<a id="cancel_shortcode_module" href="#"></a>').text(C.close),l=g('<a id="save_shortcode_module" href="#"></a>').text(C.save),a=g('<textarea class="custom_css_editor_area" name="custom_css"></textarea>'),o=g("<div id='TB_bottom'></div>").append(l,i),r="";t.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.add_shortcode_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),t.append(n,o),g("#asasTB_closeWindowButton").click(k),n.append(a),t.css({visibility:"visible"}),i.click(k),l.click(function(e){if(e.preventDefault(),(r=a.val()).match(/^\[el_((\w?){0,}row|separator).*?\]/)||(r.match(/\]$/)&&r.match(/^\[.*/)||(r="[el_text_html]"+r+"[/el_text_html]"),r='[el_row][el_column column="12"]'+r+"[/el_column][/el_row]"),""==r)return k();g.ajax({type:"POST",url:ajaxurl,data:{action:"builder_add_shortcode",_abuilder_nonce:B,shortcode:r},dataType:"html",context:this}).done(function(e){e=e.replace(/\\/g,"");var t=g(".editor-worksheet"),n=g(e);u(n),1==t.find(".dropable-element").length&&""==t.find(".dropable-element").text()?t.html(n):t.append(n),c(),m(),y(),s(),T(),w(),k()})})}),g(".custom_template_button").click(function(e){e.preventDefault(),null===document.getElementById("TB_new_overlay")&&(g("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),g("#TB_new_overlay").click(k),g("body").addClass("modal-open"));var t=g("#TB_new_window"),n=g("<div class='asTB_content_container'></div>"),i=g('<a id="cancel_shortcode_module" class="btn"  href="#"></a>').text(C.close),l=g("#template_category_options").clone(),a=g("<div id='TB_bottom'></div>").append(i),o=g('<input placeholder="'+C.search_placehold+'" name="stemp" type="text" />'),r=g('<input type="hidden" name="category_slug" value="" />');o.addClass("search-template");var d=g('<form id="asTB_content" method="post"></form>'),c=g('<div class="spiner"><i class="fa-spinner"></i></div>');d.append(o,r,'<div class="choose-templates"></div>'),n.append(l,d),t.addClass("block-loader"),t.append(c),t.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.block_library_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),t.append(n,a),l.find(".select-category").each(function(){g(this).click(function(e){e.preventDefault();var t=g(this).data("slug");return r.val(t),o.val(""),p(1)})}),o.unbind("keydown").unbind("keyup").keydown(function(e){if(13==e.keyCode)return e.preventDefault(),p(1)}).keyup(function(){g(this).val().length<3||setTimeout(function(){p(1)},1e3)}),g("#asasTB_closeWindowButton").click(k),p(1),t.css({visibility:"visible"}),l.show(),i.click(k)}),E=g("#abuilder_css_edit"),W=g("#abuilder_css_field"),E.click(function(e){e.preventDefault(),null===document.getElementById("TB_new_overlay")&&(g("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),g("#TB_new_overlay").click(k),g("body").addClass("modal-open"));var t=g("#TB_new_window"),n=g("<form id='asTB_content' method='post'></form>"),i=g('<a id="save_shortcode_module" href="#"></a>').text(C.save),l=g('<a id="cancel_shortcode_module" href="#"></a>').text(C.cancel),a=g('<textarea class="custom_css_editor_area" name="custom_css"></textarea>'),o=g("<div id='TB_bottom'></div>").append(i,l),r=W.val();a.val(r),t.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.custom_css_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),t.append(n,o),g("#asasTB_closeWindowButton").click(k),n.append(a),t.css({visibility:"visible"}),l.click(k),i.click(function(e){e.preventDefault(),r=a.val(),W.val(r),k()})}),g(window).resize(function(){g(document).scroll()}),g(document).scroll(function(){var e=g("#abuilder"),t=g(window).scrollTop(),n=g(".element-builders",e),i=e.offset().top,l=e.width(),a=g(".editor-container");i+10<t?(n.addClass("editor-stciky"),n.width(l-24),a.css("margin-top",n.outerHeight())):(n.removeClass("editor-stciky"),n.width("100%"),a.css("margin-top",0))})});