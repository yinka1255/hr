!function(a){"use strict";var b=function(){this.pb=a("#gdlr-core-page-builder"),this.pb_val=a("#gdlr-core-page-builder-val"),this.pb_nonce=a("#page_builder_security").val(),this.pb_tip=this.pb.siblings("#gdlr-core-page-builder-tip"),this.head_nav=this.pb.find("#gdlr-core-page-builder-head-nav"),this.head_content=this.pb.find("#gdlr-core-page-builder-head-content"),this.btn_full_screen=this.head_nav.find("#gdlr-core-page-builder-head-full-screen"),this.btn_reset=this.pb.find("#gdlr-core-page-builder-head-action-reset"),this.btn_save_template=this.pb.find("#gdlr-core-page-builder-head-action-save-template"),this.btn_view_mode=this.pb.find("#gdlr-core-page-builder-head-action-mode-section"),this.btn_live_mode=this.pb.find("#gdlr-core-page-builder-head-action-live-mode, #gdlr-core-page-builder-head-action-live-mode-alt"),this.content_stack=[],this.content_stack_active=-1,this.btn_undo=this.pb.find("#gdlr-core-page-builder-head-action-undo"),this.btn_redo=this.pb.find("#gdlr-core-page-builder-head-action-redo"),this.body_content=this.pb.children("#gdlr-core-page-builder-body"),this.body_container=this.body_content.children("#gdlr-core-page-builder-container"),this.init()};b.prototype={init:function(){var b=this;b.bind_fixed_nav(),b.bind_head_nav(),b.bind_head_action(),b.bind_full_screen(),b.bind_view_mode(),b.bind_wrapper_action(),b.bind_column_action(),b.bind_item_action();var c=b.body_content.find(".gdlr-core-page-builder-item-container-preview");c.find("a").attr("href","#gdlr-pb-link").off(),"undefined"!=typeof Strip&&Strip.disable(),b.bind_container_area(b.body_content),a("#post-preview, #publish, #save-post").click(function(){b.pb_update()}),b.pb.on("gdlr-core-element-resize",function(){a(window).trigger("resize")}),"undefined"!=typeof YoastSEO&&"function"==typeof YoastSEO.app.registerPlugin&&(YoastSEO.app.registerPlugin("gdlrCorePB",{status:"ready"}),YoastSEO.app.registerModification("content",a.proxy(b.get_seo_content,b),"gdlrCorePB",5)),b.pb.on("gdlr-core-element-change",function(){a(window).trigger("resize"),"undefined"!=typeof YoastSEO&&"function"==typeof YoastSEO.app.pluginReloaded&&YoastSEO.app.pluginReloaded("gdlrCorePB")}),b.pb_tip.length>0&&b.pb.on("gdlr-core-show-tooltip",function(c){b.pb_tip.siblings(".gdlr-core-page-builder-tip");b.pb_tip.fadeIn(400),b.pb_tip.find(".gdlr-core-page-builder-tip-dismiss").click(function(){b.pb_tip.fadeOut(400,function(){a(this).remove()})}),b.pb.unbind("gdlr-core-show-tooltip",c.handleObj.handler,c),b.ajax_pb_update_option("gdlr-core-page-builder-tip",1)})},get_seo_content:function(b){var c=this;return c.pb.find(".gdlr-core-page-builder-item-container-preview").each(function(){b+=a(this).children().not("script, style").html()}),b},pb_update:function(){var b=this,c=[];b.body_container.children("[data-template]").each(function(){c.push(b.pb_update_tempalte_val(a(this)))}),b.pb_val.val(JSON.stringify(c))},pb_update_tempalte_val:function(b){var c=this,d={};if(d.template=b.attr("data-template"),d.type=b.attr("data-type"),b.attr("data-column")&&(d.column=b.attr("data-column")),b.data("value")&&(d.value=b.data("value")),"wrapper"==b.attr("data-template")){var e;e="background"==b.attr("data-type")?b.children(".gdlr-core-page-builder-wrapper-content").children(".gdlr-core-page-builder-wrapper-content-margin").children(".gdlr-core-page-builder-wrapper-content-wrap").children(".gdlr-core-page-builder-wrapper-container"):"sidebar"==b.attr("data-type")?b.children().children(".gdlr-core-page-builder-wrapper-sidebar-container").children(".gdlr-core-page-builder-wrapper-sidebar-content").children():b.children(".gdlr-core-page-builder-column-content").children(".gdlr-core-page-builder-column-content-margin").children(".gdlr-core-page-builder-column-content-wrap").children(".gdlr-core-page-builder-column-container"),e.children("[data-template]").each(function(){d.items||(d.items=[]),d.items.push(c.pb_update_tempalte_val(a(this)))})}return d},update_undo_stack:function(a){a||(this.content_stack_active>=page_builder_var.settings.undo_times?this.content_stack.shift():(this.content_stack_active++,this.content_stack.splice(this.content_stack_active,page_builder_var.settings.undo_times))),this.content_stack[this.content_stack_active]=this.body_container.children().gdlr_core_clone()},update_undo_content:function(){this.body_container.html(this.content_stack[this.content_stack_active]),this.bind_container_area(this.body_content)},bind_view_mode:function(){var b=this;b.btn_view_mode.children(".gdlr-core-page-builder-head-action-mode").click(function(){var c=a(this).attr("data-mode");b.body_content.attr("data-mode")!=c&&(b.btn_view_mode.attr("data-mode",c),b.body_content.attr("data-mode",c),b.btn_live_mode.attr("data-mode",c),"live"==c?b.body_content.addClass("gdlr-core-pb-livemode").removeClass("gdlr-core-pb-blockmode"):b.body_content.addClass("gdlr-core-pb-blockmode").removeClass("gdlr-core-pb-livemode"),b.pb.trigger("gdlr-core-element-resize"),b.ajax_pb_update_option("gdlr-core-page-builder-view-mode",c))}),b.btn_live_mode.children().click(function(){if(!a(this).hasClass("gdlr-core-active")){var c=a(this).attr("data-live-mode");b.btn_live_mode.children('[data-live-mode="'+c+'"]').addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active"),"edit"==c?b.body_content.removeClass("gdlr-core-live-preview").addClass("gdlr-core-live-edit"):b.body_content.removeClass("gdlr-core-live-edit").addClass("gdlr-core-live-preview"),b.pb.trigger("gdlr-core-element-resize")}});var c=a(b.get_live_mode_container_css()).appendTo("body");a(window).resize(function(){c.remove(),c=a(b.get_live_mode_container_css()).appendTo("body")})},get_live_mode_container_css:function(){var a=(this.body_content.width()-this.body_container.width())/2,b=".gdlr-core-pb-livemode .gdlr-core-page-builder-wrapper{margin-left:-"+a+"px; margin-right:-"+a+"px}";return'<style type="text/css">'+b+"</style>"},bind_fixed_nav:function(){var e,f,b=this,c=b.pb.children(".gdlr-core-page-builder-head"),d=b.pb.children(".gdlr-core-page-builder-head-sub");a(window).scroll(function(){if(c.hasClass("gdlr-core-fixed"))if(a(window).scrollTop()+32<b.pb.offset().top+d.height()+0){var g=c.clone();g.insertAfter(c),g.slideUp(200,function(){a(this).remove()}),d.css("height",""),b.head_nav.children(".gdlr-core-page-builder-head-nav-item.gdlr-core-active").removeClass("gdlr-core-active"),b.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),e.addClass("gdlr-core-active"),f.addClass("gdlr-core-active").show(),c.removeClass("gdlr-core-fixed").css({width:"",display:"block"})}else a(window).scrollTop()+0>b.pb.offset().top+b.pb.outerHeight()?c.addClass("gdlr-core-outside").slideUp(200):c.hasClass("gdlr-core-outside")&&c.removeClass("gdlr-core-outside").slideDown(200);else a(window).scrollTop()+32>=b.pb.offset().top+c.outerHeight()+0&&a(window).scrollTop()+0<b.pb.offset().top+b.pb.outerHeight()&&(d.css("height",c.outerHeight()),e=b.head_nav.children(".gdlr-core-page-builder-head-nav-item.gdlr-core-active").removeClass("gdlr-core-active"),f=b.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),c.addClass("gdlr-core-fixed").css({display:"none",width:b.pb.outerWidth()}).slideDown(200))}),a(window).resize(function(){c.hasClass("gdlr-core-fixed")&&c.css({width:b.pb.outerWidth()})}),b.btn_full_screen.click(function(){c.hasClass("gdlr-core-fixed")&&c.hide()})},bind_head_nav:function(){var b=this;b.head_nav.children(".gdlr-core-page-builder-head-nav-item").click(function(){var c=a(this).attr("data-nav-type");a(this).hasClass("gdlr-core-active")?(a(this).removeClass("gdlr-core-active"),b.head_content.children('[data-content-type="'+c+'"]').removeClass("gdlr-core-active").css("display","block").slideUp(150)):(a(this).addClass("gdlr-core-active"),a(this).siblings(".gdlr-core-page-builder-head-nav-item").removeClass("gdlr-core-active"),b.head_content.children(".gdlr-core-active").length?(b.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),b.head_content.children('[data-content-type="'+c+'"]').addClass("gdlr-core-active").css({display:"none"}).fadeIn(150)):b.head_content.children('[data-content-type="'+c+'"]').addClass("gdlr-core-active").css({display:"none"}).slideDown(150))}),b.head_content.on("input",".gdlr-core-page-builder-head-content-search",gdlr_core_debounce(function(){var b=a(this).val();b.length>0?a(this).siblings().children(".gdlr-core-pb-list-draggable").each(function(){a(this).is('[data-title*="'+b+'"], [data-type*="'+b+'"]')?a(this).css({display:"block"}):a(this).css({display:"none"})}):a(this).siblings().children(".gdlr-core-pb-list-draggable").css({display:"block"})},300)),b.head_content.find(".gdlr-core-template-type-button").click(function(){if(!a(this).hasClass("gdlr-core-active")){a(this).addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active");var b=a(this).attr("data-type");a(this).parent().siblings(".gdlr-core-page-builder-head-content-template-container").each(function(){a(this).attr("data-type")==b?a(this).addClass("gdlr-core-active").css({display:"none"}).fadeIn(150):a(this).removeClass("gdlr-core-active").hide()})}}),b.head_content.find(".gdlr-core-pb-list-draggable").each(function(){b.bind_head_nav_item(a(this))}),b.head_content.on("click",".gdlr-core-page-builder-head-content-custom-template-remove",function(){var c=a(this).closest(".gdlr-core-page-builder-head-content-custom-template-item");return gdlr_core_confirm_box({success:function(){b.ajax_get_template(null,{data:{security:b.pb_nonce,action:"gdlr_core_remove_pb_custom_template",slug:c.attr("data-template-slug")},success:function(b){"failed"==b.status&&(template.slideUp(200,function(){a(this).remove()}),gdlr_core_alert_box({status:b.status,head:b.head,message:b.message}))}}),c.fadeOut(200,function(){a(this).remove()})}}),!1})},bind_head_nav_item:function(b){var c=this;b.draggable({addClasses:!1,connectToSortable:".gdlr-container-sortable",helper:c.sortable_helper,cursorAt:{top:20,left:54},start:function(){if(c.body_content.is(".gdlr-core-pb-livemode.gdlr-core-live-preview"))return!1}}),b.click(function(b){if(!a(b.target).is(".fa-remove")){var d=c.get_template(a(this));c.body_container.append(d),c.update_undo_stack(),d.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){a(this).css({opacity:"",transform:""})}),c.update_element_preview(d),gdlr_core_alert_box({status:"success",head:page_builder_var.text.item_added,duration:1e3}),c.pb.trigger("gdlr-core-show-tooltip"),c.sortable_column_order()}})},bind_full_screen:function(){var b=this,c=a("#wpwrap"),e=(a("#wpadminbar"),b.pb.parent());b.btn_full_screen.click(function(){a(this).hasClass("gdlr-core-active")?(a(this).removeClass("gdlr-core-active"),c.css({display:""}),a("html").css({"padding-top":""}),e.append(b.pb),b.pb.removeClass("gdlr-core-fullscreen"),a(window).scrollTop(b.pb.offset().top).trigger("resize").trigger("scroll")):(a(this).addClass("gdlr-core-active"),c.css({display:"none"}),a("html").css({"padding-top":0}),a("body").append(b.pb.addClass("gdlr-core-fullscreen")),a(window).scrollTop(0).trigger("resize").trigger("scroll"))}),b.head_nav.find(".gdlr-core-page-builder-head-nav-update").click(function(){if(!a(this).hasClass("gdlr-core-now-loading")){var c=a(this).addClass("gdlr-core-now-loading"),d=a(this).attr("data-post-id"),e=[];b.body_container.children().each(function(){e.push(b.pb_update_tempalte_val(a(this)))}),a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:b.pb_nonce,action:"gdlr_core_save_page_builder_data",post_id:d,value:JSON.stringify(e)},dataType:"json",error:function(a,b,d){c.removeClass("gdlr-core-now-loading"),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(a,b,d)},success:function(a){c.removeClass("gdlr-core-now-loading"),gdlr_core_alert_box({status:a.status,head:a.head,message:a.message})}})}})},get_template:function(b){var c=this,d="";if("wrapper"==b.attr("data-template"))if("column"==b.attr("data-type")){var e=b.attr("data-column");d=a(page_builder_var.template.column),d.addClass("gdlr-core-column-"+e).attr("data-column",e),d.find(".gdlr-core-page-builder-column-head-title").html(page_builder_var.column[e]),c.bind_container_area(d)}else d=a(page_builder_var.template[b.attr("data-type")]),c.bind_container_area(d);else"element"==b.attr("data-template")?(d=a(page_builder_var.template.element),d.attr("data-type",b.attr("data-type")),d.find(".gdlr-core-page-builder-item-container-item-title, .gdlr-core-page-builder-item-head-item-title").html(b.attr("data-title"))):"template"==b.attr("data-template")?(d=a(page_builder_var.template.template),d.attr("data-type",b.attr("data-type")),d.attr("data-template-slug",b.attr("data-template-slug")),c.ajax_get_template(d,{data:{security:c.pb_nonce,action:"gdlr_core_get_pb_template",slug:b.attr("data-template-slug")}})):"custom-template"==b.attr("data-template")&&(d=a(page_builder_var.template.template),d.attr("data-type",b.attr("data-type")),d.attr("data-template-slug",b.attr("data-template-slug")),c.ajax_get_template(d,{data:{security:c.pb_nonce,action:"gdlr_core_get_pb_custom_template",slug:b.attr("data-template-slug")}}));return d},bind_wrapper_action:function(){var b=this;b.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-remove",function(){a(this).closest(".gdlr-core-page-builder-wrapper").fadeOut(200,function(){a(this).remove(),b.pb.trigger("gdlr-core-element-change"),b.update_undo_stack()})}),b.body_content.on("dblclick",".gdlr-core-page-builder-wrapper",function(){var c=a(this);return b.ajax_get_options({data:{security:b.pb_nonce,action:"gdlr_core_get_pb_options",template:c.attr("data-template"),type:c.attr("data-type"),value:c.data("value")}},c),!1}),b.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-edit",function(){var c=a(this).closest(".gdlr-core-page-builder-wrapper");b.ajax_get_options({data:{security:b.pb_nonce,action:"gdlr_core_get_pb_options",template:c.attr("data-template"),type:c.attr("data-type"),value:c.data("value")}},c)}),b.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-save",function(){var c=[];c.push(b.pb_update_tempalte_val(a(this).closest(".gdlr-core-page-builder-wrapper"))),b.lb_save_custom_template(c,"wrapper")}),b.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-copy",function(){var c=a(this).closest(".gdlr-core-page-builder-wrapper"),d=c.gdlr_core_clone();d.insertAfter(c),d.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){a(this).css({opacity:"",transform:""})}),b.update_undo_stack(),b.bind_container_area(d)})},bind_column_action:function(){var b=this;b.body_container.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-size i",function(){var c=a(this).closest(".gdlr-core-page-builder-column"),d=c.attr("data-column"),e=a(this).closest(".gdlr-core-page-builder-column-head").find(".gdlr-core-page-builder-column-head-title"),f=10,g=60;for(var h in page_builder_var.column)if(h<d)f=h;else if(h>d){g=h;break}a(this).hasClass("gdlr-core-page-builder-column-increase")?(d!=g&&(c.removeClass("gdlr-core-column-"+d),e.html(page_builder_var.column[g]),c.addClass("gdlr-core-column-"+g).attr("data-column",g)),b.sortable_column_order(),b.pb.trigger("gdlr-core-element-resize"),b.update_undo_stack()):a(this).hasClass("gdlr-core-page-builder-column-decrease")&&(d!=f&&(c.removeClass("gdlr-core-column-"+d),e.html(page_builder_var.column[f]),c.addClass("gdlr-core-column-"+f).attr("data-column",f)),b.sortable_column_order(),b.pb.trigger("gdlr-core-element-resize"),b.update_undo_stack())}),b.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-remove",function(){a(this).closest(".gdlr-core-page-builder-column").fadeOut(200,function(){a(this).remove(),b.sortable_column_order(),b.pb.trigger("gdlr-core-element-change"),b.update_undo_stack()})}),b.body_content.on("dblclick",".gdlr-core-page-builder-column",function(c){if(a(c.target).is(".gdlr-core-page-builder-column-increase, .gdlr-core-page-builder-column-decrease"))return!1;var d=a(this);return b.ajax_get_options({data:{security:b.pb_nonce,action:"gdlr_core_get_pb_options",template:d.attr("data-template"),type:d.attr("data-type"),value:d.data("value")}},d),!1}),b.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-edit",function(){var c=a(this).closest(".gdlr-core-page-builder-column");b.ajax_get_options({data:{security:b.pb_nonce,action:"gdlr_core_get_pb_options",template:c.attr("data-template"),type:c.attr("data-type"),value:c.data("value")}},c)}),b.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-save",function(){var c=[];c.push(b.pb_update_tempalte_val(a(this).closest(".gdlr-core-page-builder-column"))),b.lb_save_custom_template(c,"column")}),b.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-copy",function(){var c=a(this).closest(".gdlr-core-page-builder-column"),d=c.gdlr_core_clone();d.insertAfter(c),d.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){a(this).css({opacity:"",transform:""})}),b.update_undo_stack(),b.bind_container_area(d)})},bind_item_action:function(){var b=this;b.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-remove",function(){a(this).closest(".gdlr-core-page-builder-item").fadeOut(200,function(){a(this).remove(),b.pb.trigger("gdlr-core-element-change"),b.update_undo_stack()})}),b.body_content.on("dblclick",".gdlr-core-page-builder-item",function(){var c=a(this);return b.ajax_get_options({data:{security:b.pb_nonce,action:"gdlr_core_get_pb_options",template:c.attr("data-template"),type:c.attr("data-type"),value:c.data("value")}},c),!1}),b.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-edit",function(){var c=a(this).closest(".gdlr-core-page-builder-item");b.ajax_get_options({data:{security:b.pb_nonce,action:"gdlr_core_get_pb_options",template:c.attr("data-template"),type:c.attr("data-type"),value:c.data("value")}},c)}),b.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-save",function(){var c=[];c.push(b.pb_update_tempalte_val(a(this).closest(".gdlr-core-page-builder-item"))),b.lb_save_custom_template(c,"element")}),b.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-copy",function(){var c=a(this).closest(".gdlr-core-page-builder-item"),d=c.gdlr_core_clone();d.insertAfter(c),d.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){a(this).css({opacity:"",transform:""})}),b.update_undo_stack()})},bind_head_action:function(){var b=this;b.update_undo_stack(),b.btn_undo.click(function(){b.content_stack_active>0?(b.content_stack_active--,b.update_undo_content()):gdlr_core_alert_box({status:"success",head:page_builder_var.text.undo_end})}),b.btn_redo.click(function(){"undefined"!=typeof b.content_stack[b.content_stack_active+1]?(b.content_stack_active++,b.update_undo_content()):gdlr_core_alert_box({status:"success",head:page_builder_var.text.redo_end})}),b.btn_reset.click(function(){gdlr_core_confirm_box({success:function(){b.body_container.empty(),b.update_undo_stack()},sub:""})}),b.btn_save_template.click(function(){var c=[];b.body_container.children().each(function(){c.push(b.pb_update_tempalte_val(a(this)))}),b.lb_save_custom_template(c,"wrapper")}),b.btn_save_template.contextmenu(function(){var c=[];b.body_container.children().each(function(){c.push(b.pb_update_tempalte_val(a(this)))}),console.log(JSON.stringify(c))})},ajax_pb_update_option:function(b,c){var d=this;"undefined"!=typeof b&&"undefined"!=typeof c&&a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:d.pb_nonce,action:"gdlr_core_pb_update_option",slug:b,value:c},dataType:"json",error:function(a,b,c){console.log(a,b,c)},success:function(a){"undefined"!=typeof a&&a&&console.log(a)}})},ajax_get_options:function(b,c){var d=this,e=a('<div class="gdlr-core-page-builder-loading" ></div>'),f=a.extend({beforeSend:function(a,b){var c=d.pb.offset().left+d.pb.outerWidth()/2;e.css({display:"none",left:c}).appendTo("body"),e.fadeIn(150)},error:function(a,b,c){e.remove(),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(a,b,c)},success:function(a){e.remove(),"success"==a.status?d.lb_options(a.option_content,c):"failed"==a.status&&gdlr_core_alert_box({status:a.status,head:a.head,message:a.message})}},b);a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:f.data,dataType:"json",beforeSend:f.beforeSend,error:f.error,success:f.success})},ajax_get_skin_options:function(b){var c=this,d=a('<div class="gdlr-core-page-builder-loading" ></div>');a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:c.pb_nonce,action:"gdlr_core_get_skin_options"},dataType:"json",beforeSend:function(a,b){d.css({display:"none"}).appendTo("body"),d.fadeIn(150)},error:function(a,b,c){d.remove(),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(a,b,c)},success:function(a){d.remove(),"success"==a.status?c.lb_skin_options(a.option_content,b):"failed"==a.status&&gdlr_core_alert_box({status:a.status,head:a.head,message:a.message})}})},ajax_update_skin:function(b,c){var d=this;a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:d.pb_nonce,action:"gdlr_core_update_skin",value:b,skin:c.val()},dataType:"json",error:function(a,b,c){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(a,b,c)},success:function(b){if(console.log(b),"success"==b.status){if(console.log(b),"undefined"!=typeof b.combobox&&c.html(b.combobox),"undefined"!=typeof b.style){var d=a("#gdlr-core-skin-style-temp");d.length||(d=a('<style type="text/css" id="gdlr-core-skin-style-temp" ></style>'),a("body").append(d)),d.html(b.style)}}else"failed"==b.status&&gdlr_core_alert_box({status:b.status,head:b.head,message:b.message})}})},ajax_get_template:function(b,c){var d=this,e=a.extend({error:function(a,b,c){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(a,b,c)},success:function(c){if("success"==c.status){var e=a(c.content);b.replaceWith(e),d.pb.trigger("gdlr-core-element-change"),d.update_undo_stack(!0),d.bind_container_area(e)}else"failed"==c.status&&(b.slideUp(200,function(){a(this).remove()}),gdlr_core_alert_box({status:c.status,head:c.head,message:c.message}))}},c);a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:e.data,dataType:"json",beforeSend:e.beforeSend,error:e.error,success:e.success})},ajax_save_template:function(b,c){var e=a.extend({error:function(a,b,c){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(a,b,c)},success:function(a){"success"==a.status&&gdlr_core_alert_box({status:a.status,head:a.head,message:a.message}),gdlr_core_alert_box({status:a.status,head:a.head,message:a.message})}},c);a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:e.data,dataType:"json",beforeSend:e.beforeSend,error:e.error,success:e.success})},update_element_preview:function(b){var c=this;b.find(".gdlr-core-page-builder-item-container-preview").each(function(){var b=a(this).closest(".gdlr-core-page-builder-item"),d=a(this).addClass("gdlr-core-now-loading");a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:c.pb_nonce,action:"gdlr_core_get_pb_element_preview",type:b.attr("data-type"),value:b.data("value")},dataType:"json",error:function(a,b,c){console.log(a,b,c)},success:function(b){if(d.removeClass("gdlr-core-now-loading"),"success"==b.status&&b.preview_content){var e=a(b.preview_content);e.find("a").attr("href","#gdlr-pb-link").removeClass("gdlr-core-ilightbox"),d.html(e),c.pb.trigger("gdlr-core-element-change"),c.update_undo_stack(!0)}}})})},update_wrapper_preview:function(b){var c=this,d=c.pb_update_tempalte_val(b);b.addClass("gdlr-core-now-loading"),a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:c.pb_nonce,action:"gdlr_core_get_pb_wrapper_preview",type:b.attr("data-type"),value:d},dataType:"json",error:function(a,b,c){console.log(a,b,c)},success:function(d){if(b.removeClass("gdlr-core-now-loading"),"success"==d.status&&d.preview_content){var e=a(d.preview_content);b.replaceWith(e),c.bind_container_area(e)}}})},lb_save_custom_template:function(b,c){var d=this,e=a(page_builder_var.template.custom_template_lb);a("body").append(e),e.css({opacity:0}).animate({opacity:1},200),e.find(".gdlr-core-custom-template-lb-head-close").click(function(){e.animate({opacity:0},200,function(){a(this).remove()})}),e.find(".gdlr-core-custom-template-save").click(function(){var f=a(this).siblings(".gdlr-core-custom-template-name").val();""==f?gdlr_core_alert_box({status:"failed",head:page_builder_var.template.custom_template_no_text_head,message:page_builder_var.template.custom_template_no_text_message}):(e.animate({opacity:0},200,function(){a(this).remove()}),a.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:d.pb_nonce,action:"gdlr_core_save_pb_custom_template",value:b,type:c,title:f},dataType:"json",error:function(a,b,c){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(a,b,c)},success:function(b){if("success"==b.status){var c=a(b.nav_item);d.head_content.children('[data-content-type="custom-template"]').find(".gdlr-core-page-builder-head-content-custom-template-container").append(c),d.bind_head_nav_item(c)}gdlr_core_alert_box({status:b.status,head:b.head,message:b.message})}}))})},lb_options:function(b,c){var d=this,e=a('<div class="gdlr-core-lightbox-content-wrapper"></div>'),f=a('<div class="gdlr-core-lightbox-content"></div>');e.append(f),f.append(b),a("body").append(e).css({overflow:"hidden",width:a("body").width()}),e.css({opacity:0}).animate({opacity:1},400);var g=new gdlrCoreHtmlOption(f);f.find(".gdlr-core-html-option-skin-edit").click(function(){var b=a(this).siblings(".gdlr-core-html-option-item-input").find("select");d.ajax_get_skin_options(b)});var h=f.find("#gdlr-core-page-builder-options-tab-head"),i=f.find("#gdlr-core-page-builder-options-tab-content");h.children(".gdlr-core-page-builder-options-tab-head-item").click(function(){if(!a(this).hasClass("gdlr-core-active")){var b=a(this).attr("data-tab-slug");a(this).addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active"),i.find('[data-tab-slug="'+b+'"]').fadeIn(200).siblings().css("display","none")}}),f.find("#gdlr-core-page-builder-options-head-close").click(function(){e.fadeOut(200,function(){a(this).remove(),a("body").css({overflow:"",width:""})})});var j=f.find("#gdlr-core-page-builder-options-save");j.click(function(){var b=g.get_val();c.data("value",b),e.fadeOut(200,function(){a(this).remove(),a("body").css({overflow:"",width:""})}),d.update_undo_stack(),c.is(".gdlr-core-page-builder-item")?d.update_element_preview(c):c.is(".gdlr-core-page-builder-wrapper, .gdlr-core-page-builder-column")&&d.update_wrapper_preview(c)});var k=!1;f.children().click(function(){k=!0}),e.click(function(){k||j.trigger("click"),k=!1})},lb_skin_options:function(b,c){var d=this,e=a('<div class="gdlr-core-lightbox-content-wrapper gdlr-core-lightbox-skin-content-wrapper"></div>'),f=a('<div class="gdlr-core-lightbox-content"></div>');e.append(f),f.append(b),a("body").append(e),e.css({opacity:0}).animate({opacity:1},400);var g=new gdlrCoreHtmlOption(f);f.find("#gdlr-core-page-builder-options-head-close").click(function(){e.fadeOut(200,function(){a(this).remove()})});var h=f.find("#gdlr-core-page-builder-options-save");h.click(function(){var b=g.get_val();d.ajax_update_skin(b,c),e.fadeOut(200,function(){a(this).remove()})});var i=!1;f.children().click(function(){i=!0}),e.click(function(){i||h.trigger("click"),i=!1})},bind_container_area:function(b){var c=this;b.find(".gdlr-container-sortable, .gdlr-core-wrapper-sortable, .gdlr-core-column-sortable").sortable({connectWith:".gdlr-container-sortable, .gdlr-core-wrapper-sortable, .gdlr-core-column-sortable",cursorAt:{top:20,left:54},helper:c.sortable_helper,placeholder:"gdlr-core-page-builder-placeholder",tolerance:"pointer",delay:100,activate:function(b,d){c.body_content.is(".gdlr-core-pb-livemode.gdlr-core-live-preview")&&a(this).sortable("cancel")},start:function(a,b){c.body_content.is(".gdlr-core-pb-livemode.gdlr-core-live-preview")||(c.sortable_start(a,b),c.pb.addClass("gdlr-core-dragging"))},stop:function(a,b){c.sortable_stop(a,b),c.pb.removeClass("gdlr-core-dragging"),c.pb.trigger("gdlr-core-element-resize"),c.pb.trigger("gdlr-core-show-tooltip")},change:function(a,b){c.sortable_location(a,b)},update:function(b,d){if(d.item.parent().hasClass("gdlr-core-wrapper-sortable")){if(d.item.is(".gdlr-core-page-builder-wrapper, .gdlr-core-page-builder-helper-wrapper"))return void a(this).sortable("cancel")}else if(d.item.parent().hasClass("gdlr-core-column-sortable")&&d.item.is(".gdlr-core-page-builder-wrapper, .gdlr-core-page-builder-helper-wrapper, .gdlr-core-page-builder-column, .gdlr-core-page-builder-helper-column"))return void a(this).sortable("cancel");null==d.sender&&c.update_undo_stack()}}),c.sortable_column_order()},sortable_start:function(a,b){this.sortable_column_order(),this.sortable_location(a,b),b.item.is(".gdlr-core-page-builder-item, .gdlr-core-page-builder-helper-item")?b.placeholder.addClass("gdlr-core-page-builder-placeholder-item"):b.item.is(".gdlr-core-page-builder-column, .gdlr-core-page-builder-helper-column")?b.placeholder.addClass("gdlr-core-page-builder-placeholder-column"):b.item.is(".gdlr-core-page-builder-wrapper, .gdlr-core-page-builder-helper-wrapper")&&b.placeholder.addClass("gdlr-core-page-builder-placeholder-wrapper")},sortable_stop:function(b,c){if(c.item.hasClass("gdlr-core-page-builder-helper")){var d=this.get_template(c.item);c.item.replaceWith(d),c.item=d,this.update_element_preview(d)}this.sortable_column_order(),this.update_undo_stack(!0),c.item.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){a(this).css({opacity:"",transform:""})})},sortable_location:function(a,b){for(var c=b.placeholder.prev();"none"==c.css("display")||c.hasClass("gdlr-core-page-builder-placeholder");)c=c.prev();b.placeholder.removeClass("gdlr-core-placeholder-clear"),(c.hasClass("gdlr-core-last-row")||c.hasClass("gdlr-core-last-item")&&!b.item.is(".gdlr-core-page-builder-column, .gdlr-core-page-builder-helper-column"))&&b.placeholder.addClass("gdlr-core-placeholder-clear")},sortable_column_order:function(){var b=0;this.body_content.find(".gdlr-core-page-builder-column").removeClass("gdlr-core-last-row gdlr-core-last-item gdlr-core-first").each(function(){if("none"!=a(this).css("display")){for(var c=a(this).prev();"none"==c.css("display")||c.hasClass("gdlr-core-page-builder-placeholder");)c=c.prev();0!=b&&c.is(".gdlr-core-page-builder-column")||(a(this).addClass("gdlr-core-first"),b=0),b+=parseInt(a(this).attr("data-column")),b%60==0?(a(this).addClass("gdlr-core-last-row"),b=0):b>60&&(a(this).addClass("gdlr-core-first"),b=parseInt(a(this).attr("data-column")));for(var d=a(this).next();"none"==d.css("display")||d.hasClass("gdlr-core-page-builder-placeholder");)d=d.next();d.is(".gdlr-core-page-builder-column")||a(this).addClass("gdlr-core-last-item")}})},sortable_helper:function(b){var c=a('<div class="gdlr-core-page-builder-helper" ></div>'),d=a(b.currentTarget);return"wrapper"!=d.attr("data-template")&&"template"!=d.attr("data-template")&&"custom-template"!=d.attr("data-template")||("column"==d.attr("data-type")?c.addClass("gdlr-core-page-builder-helper-column"):c.addClass("gdlr-core-page-builder-helper-wrapper")),
a.each(d.prop("attributes"),function(){this.name.indexOf("data-")!=-1&&c.attr(this.name,this.value)}),c}},a(document).ready(function(){new b,a(window).load(function(b){var c=a(window).scrollTop();a(window).trigger("resize"),a(window).scroll(function(b){a(window).scrollTop(c),a(window).unbind("scroll",b.handleObj.handler,b)})})})}(jQuery);